/**
 * This file was auto-generated by Fern from our API Definition.
 */
package com.phenoml.api.resources.agent;

import com.phenoml.api.core.ClientOptions;
import com.phenoml.api.core.RequestOptions;
import com.phenoml.api.core.Stream;
import com.phenoml.api.core.Suppliers;
import com.phenoml.api.resources.agent.prompts.PromptsClient;
import com.phenoml.api.resources.agent.requests.AgentChatRequest;
import com.phenoml.api.resources.agent.requests.AgentGetChatMessagesRequest;
import com.phenoml.api.resources.agent.requests.AgentListRequest;
import com.phenoml.api.resources.agent.requests.AgentStreamChatRequest;
import com.phenoml.api.resources.agent.types.AgentChatResponse;
import com.phenoml.api.resources.agent.types.AgentChatStreamEvent;
import com.phenoml.api.resources.agent.types.AgentCreateRequest;
import com.phenoml.api.resources.agent.types.AgentDeleteResponse;
import com.phenoml.api.resources.agent.types.AgentGetChatMessagesResponse;
import com.phenoml.api.resources.agent.types.AgentListResponse;
import com.phenoml.api.resources.agent.types.AgentResponse;
import com.phenoml.api.resources.agent.types.JsonPatchOperation;
import java.util.List;
import java.util.function.Supplier;

public class AgentClient {
    protected final ClientOptions clientOptions;

    private final RawAgentClient rawClient;

    protected final Supplier<PromptsClient> promptsClient;

    public AgentClient(ClientOptions clientOptions) {
        this.clientOptions = clientOptions;
        this.rawClient = new RawAgentClient(clientOptions);
        this.promptsClient = Suppliers.memoize(() -> new PromptsClient(clientOptions));
    }

    /**
     * Get responses with HTTP metadata like headers
     */
    public RawAgentClient withRawResponse() {
        return this.rawClient;
    }

    /**
     * Creates a new PhenoAgent with specified configuration
     */
    public AgentResponse create(AgentCreateRequest request) {
        return this.rawClient.create(request).body();
    }

    /**
     * Creates a new PhenoAgent with specified configuration
     */
    public AgentResponse create(AgentCreateRequest request, RequestOptions requestOptions) {
        return this.rawClient.create(request, requestOptions).body();
    }

    /**
     * Retrieves a list of PhenoAgents belonging to the authenticated user
     */
    public AgentListResponse list() {
        return this.rawClient.list().body();
    }

    /**
     * Retrieves a list of PhenoAgents belonging to the authenticated user
     */
    public AgentListResponse list(AgentListRequest request) {
        return this.rawClient.list(request).body();
    }

    /**
     * Retrieves a list of PhenoAgents belonging to the authenticated user
     */
    public AgentListResponse list(AgentListRequest request, RequestOptions requestOptions) {
        return this.rawClient.list(request, requestOptions).body();
    }

    /**
     * Retrieves a specific agent by its ID
     */
    public AgentResponse get(String id) {
        return this.rawClient.get(id).body();
    }

    /**
     * Retrieves a specific agent by its ID
     */
    public AgentResponse get(String id, RequestOptions requestOptions) {
        return this.rawClient.get(id, requestOptions).body();
    }

    /**
     * Updates an existing agent's configuration
     */
    public AgentResponse update(String id, AgentCreateRequest request) {
        return this.rawClient.update(id, request).body();
    }

    /**
     * Updates an existing agent's configuration
     */
    public AgentResponse update(String id, AgentCreateRequest request, RequestOptions requestOptions) {
        return this.rawClient.update(id, request, requestOptions).body();
    }

    /**
     * Deletes an existing agent
     */
    public AgentDeleteResponse delete(String id) {
        return this.rawClient.delete(id).body();
    }

    /**
     * Deletes an existing agent
     */
    public AgentDeleteResponse delete(String id, RequestOptions requestOptions) {
        return this.rawClient.delete(id, requestOptions).body();
    }

    /**
     * Patches an existing agent's configuration
     */
    public AgentResponse patch(String id, List<JsonPatchOperation> request) {
        return this.rawClient.patch(id, request).body();
    }

    /**
     * Patches an existing agent's configuration
     */
    public AgentResponse patch(String id, List<JsonPatchOperation> request, RequestOptions requestOptions) {
        return this.rawClient.patch(id, request, requestOptions).body();
    }

    /**
     * Send a message to an agent and receive a JSON response.
     */
    public AgentChatResponse chat(AgentChatRequest request) {
        return this.rawClient.chat(request).body();
    }

    /**
     * Send a message to an agent and receive a JSON response.
     */
    public AgentChatResponse chat(AgentChatRequest request, RequestOptions requestOptions) {
        return this.rawClient.chat(request, requestOptions).body();
    }

    /**
     * Send a message to an agent and receive the response as a Server-Sent Events
     * (SSE) stream. Events include message_start, content_delta, tool_use,
     * tool_result, message_end, and error.
     * <p>
     * The returned Stream implements Closeable and must be closed after use to release
     * HTTP connections. Use try-with-resources or call close() explicitly.
     */
    public Stream<AgentChatStreamEvent> streamChat(AgentStreamChatRequest request) {
        return this.rawClient.streamChat(request).body();
    }

    /**
     * Send a message to an agent and receive the response as a Server-Sent Events
     * (SSE) stream. Events include message_start, content_delta, tool_use,
     * tool_result, message_end, and error.
     * <p>
     * The returned Stream implements Closeable and must be closed after use to release
     * HTTP connections. Use try-with-resources or call close() explicitly.
     */
    public Stream<AgentChatStreamEvent> streamChat(AgentStreamChatRequest request, RequestOptions requestOptions) {
        return this.rawClient.streamChat(request, requestOptions).body();
    }

    /**
     * Retrieves a list of chat messages for a given chat session
     */
    public AgentGetChatMessagesResponse getChatMessages(AgentGetChatMessagesRequest request) {
        return this.rawClient.getChatMessages(request).body();
    }

    /**
     * Retrieves a list of chat messages for a given chat session
     */
    public AgentGetChatMessagesResponse getChatMessages(
            AgentGetChatMessagesRequest request, RequestOptions requestOptions) {
        return this.rawClient.getChatMessages(request, requestOptions).body();
    }

    public PromptsClient prompts() {
        return this.promptsClient.get();
    }
}
